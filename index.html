<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>SkyType â€” Personal Typing Game</title>
  <style>
    :root{--bg1:#6b46c1;--bg2:#f687b3;--card:#ffffffcc;--glass:rgba(255,255,255,0.08)}
    *{box-sizing:border-box;font-family:Inter, system-ui, -apple-system, 'Segoe UI', Roboto, 'Helvetica Neue', Arial}
    body{margin:0;min-height:100vh;display:flex;align-items:center;justify-content:center;background:linear-gradient(180deg,var(--bg1),#ff8a80);color:#111}
    .app{width:980px;max-width:96%;background:linear-gradient(180deg,rgba(255,255,255,0.06),rgba(255,255,255,0.02));border-radius:16px;box-shadow:0 10px 30px rgba(0,0,0,0.25);overflow:hidden;border:1px solid rgba(255,255,255,0.06)}
    header{display:flex;align-items:center;gap:16px;padding:18px 22px;background:transparent}
    .logo{display:flex;align-items:center;gap:12px}
    .orb{width:46px;height:46px;border-radius:50%;background:radial-gradient(circle at 30% 30%, #fff7, #fff0),linear-gradient(180deg,#ffd6e0,#b3a8f8);display:flex;align-items:center;justify-content:center;box-shadow:0 6px 18px rgba(0,0,0,0.2)}
    .title{font-weight:700;font-size:20px}
    .subtitle{font-size:12px;color:#fff9}

    main{display:flex;gap:18px;padding:20px}
    .left{flex:1;min-width:260px;padding:18px}
    .right{width:360px;max-width:42%;padding:18px}
    .card{background:var(--card);padding:14px;border-radius:12px;box-shadow:inset 0 1px 0 rgba(255,255,255,0.4)}

    /* Game view */
    .sky{height:360px;border-radius:10px;overflow:hidden;position:relative;background:linear-gradient(180deg,#8dd3ff 0%, #8cc1ff 30%, #c7b0ff 100%);border:1px solid rgba(255,255,255,0.05)}
    .cloud{position:absolute;background:white;border-radius:999px;opacity:0.9}
    .cloud.c1{width:140px;height:48px;left:20px;top:30px}
    .cloud.c2{width:100px;height:36px;right:10px;top:60px}
    .cloud.c3{width:160px;height:56px;left:60px;top:120px}

    .ground{position:absolute;left:0;right:0;bottom:0;height:64px;background:linear-gradient(180deg,#73c8a9,#2ea36a);display:flex;align-items:center;justify-content:center}

    /* red danger line */
    .redline{position:absolute;left:0;right:0;height:8px;background:#ff3b30;bottom:64px}

    .jumper-wrap{position:absolute;left:46%;bottom:84px;height:160px;width:120px;display:flex;align-items:flex-end;justify-content:center;pointer-events:none}
    .jumper{width:64px;height:64px;border-radius:50%;background:linear-gradient(180deg,#ffe0a6,#ffb870);box-shadow:0 8px 18px rgba(0,0,0,0.2);transform-origin:center bottom}
    .rope{position:absolute;left:50%;width:180px;height:2px;transform:translateX(-50%);bottom:70px}

    @keyframes jump{0%{transform:translateY(0)}20%{transform:translateY(-110px)}45%{transform:translateY(-130px)}70%{transform:translateY(-90px)}100%{transform:translateY(0)}}

    /* falling words */
    .falling-word{position:absolute;font-weight:800;padding:6px 8px;border-radius:8px;background:rgba(255,255,255,0.95);box-shadow:0 6px 12px rgba(0,0,0,0.12);user-select:none}

    .words{display:flex;gap:8px;flex-wrap:wrap;margin-top:12px}

    .controls{display:flex;gap:8px;margin-top:12px}
    button{border:0;padding:8px 10px;border-radius:9px;font-weight:600;cursor:pointer}
    .btn-ghost{background:transparent;color:#111;border:1px solid rgba(0,0,0,0.06)}
    .btn-primary{background:#ffcc80;color:#111}

    .stat{display:flex;justify-content:space-between;padding:8px 0;border-bottom:1px dashed rgba(0,0,0,0.05)}
    .big{font-size:20px;font-weight:800}

    .typebox{margin-top:12px}
    input[type=text]{width:100%;padding:12px;border-radius:10px;border:1px solid rgba(0,0,0,0.06);font-size:16px}
    input[type=range]{width:100%}

    footer{padding:12px 18px;font-size:13px;color:#fff9;background:linear-gradient(180deg,transparent,#00000010)}

    .muted{color:#333}
    .small{font-size:12px;color:#222}

    @media (max-width:780px){main{flex-direction:column}.right{width:100%}}
  </style>
</head>
<body>
  <div class="app">
    <header>
      <div class="logo">
        <div class="orb">âœ¨</div>
        <div>
          <div class="title">SkyType</div>
          <div class="subtitle">Your personal typing adventure</div>
        </div>
      </div>
    </header>

    <main>
      <div class="left">
        <div class="card">
          <div style="display:flex;justify-content:space-between;align-items:center">
            <div>
              <div style="font-weight:800">Game</div>
              <div class="small muted">Type a falling word before it hits the red line. If it touches â€” you lose.</div>
            </div>
            <div style="text-align:right">
              <div style="font-weight:800" id="score">Score: 0</div>
              <div class="small muted">Streak: <span id="streak">0</span></div>
            </div>
          </div>

          <div class="sky" id="playArea">
            <div class="cloud c1"></div>
            <div class="cloud c2"></div>
            <div class="cloud c3"></div>

            <div class="redline" id="redline"></div>
            <div class="jumper-wrap" aria-hidden>
              <div class="rope" id="rope"></div>
              <div class="jumper" id="jumper" style="transform:translateY(0)"></div>
            </div>

            <div class="ground"></div>
          </div>

          <div class="typebox">
            <div class="words" id="wordsPreview"></div>
            <input type="text" id="input" placeholder="Type any falling word and press Space/Enter" autocomplete="off" />
          </div>

          <div class="controls">
            <button class="btn-primary" id="startBtn">Start</button>
            <button class="btn-ghost" id="stopBtn">Stop</button>
            <button class="btn-ghost" id="modeBtn">Mode: Endless</button>
            <div style="flex:1"></div>
            <div class="small muted">Level: <b id="levelLabel">1</b></div>
          </div>
        </div>

        <div style="height:12px"></div>

        <div class="card">
          <div style="font-weight:800">Word list (customize)</div>
          <div class="small muted">Add words separated by commas â€” these will fall in a loop.</div>
          <textarea id="customWords" style="width:100%;height:72px;margin-top:8px;border-radius:8px;padding:8px">adventure,mystery,spark,skip,sky,type,nova,cloud,star,friend</textarea>
          <div style="display:flex;gap:8px;margin-top:8px"><button id="applyWords" class="btn-ghost">Apply words</button><button id="resetWords" class="btn-ghost">Reset</button></div>
        </div>

      </div>

      <div class="right">
        <div class="card">
          <div style="font-weight:800">Stats & Modes</div>
          <div class="stat"><div>Accuracy</div><div id="accuracy">100%</div></div>
          <div class="stat"><div>Best Streak</div><div id="bestStreak">0</div></div>
          <div class="stat"><div>Words Typed</div><div id="typedCount">0</div></div>

          <div style="margin-top:10px;font-weight:800">Spawn settings</div>
          <div class="small muted">Simultaneous falling words</div>
          <input type="range" id="spawnRange" min="1" max="8" value="3" />
          <div class="small muted">Spawn: <span id="spawnLabel">3</span></div>

          <div style="margin-top:12px;font-weight:800">Game Tips</div>
          <ul class="small muted">
            <li>Keep your fingers on the home row: ASDF / JKL;</li>
            <li>Type the whole word exactly and press Space/Enter.</li>
            <li>Use the custom word box to practice tricky words.</li>
          </ul>
        </div>

        <div style="height:12px"></div>

        <div class="card">
          <div style="font-weight:800">Controls</div>
          <div class="small muted">Start â€” begin spawning falling words. Stop â€” pause the game. If a word touches the red line you lose and must press Start to play again.</div>
          <div style="height:8px"></div>
          <button id="exportBtn" class="btn-ghost">Export Score (copy)</button>
        </div>
      </div>
    </main>

    <footer>Made for Spark â€” type every day to get better. ðŸ¦‹</footer>
  </div>

  <script>
    // SkyType â€” falling words version
    const defaultWords = ['adventure','mystery','spark','skip','sky','type','nova','cloud','star','friend'];
    const playArea = document.getElementById('playArea');
    const redlineEl = document.getElementById('redline');
    const input = document.getElementById('input');
    const startBtn = document.getElementById('startBtn');
    const stopBtn = document.getElementById('stopBtn');
    const spawnRange = document.getElementById('spawnRange');
    const spawnLabel = document.getElementById('spawnLabel');
    const applyWords = document.getElementById('applyWords');
    const customWords = document.getElementById('customWords');
    const resetWords = document.getElementById('resetWords');
    const scoreEl = document.getElementById('score');
    const streakEl = document.getElementById('streak');
    const accuracyEl = document.getElementById('accuracy');
    const bestStreakEl = document.getElementById('bestStreak');
    const typedCountEl = document.getElementById('typedCount');
    const levelLabel = document.getElementById('levelLabel');
    const wordsPreview = document.getElementById('wordsPreview');

    let game = {
      running: false,
      wordsPool: [...defaultWords],
      wordIndex: 0,
      falling: [],
      spawnMax: 3,
      score: 0,
      streak: 0,
      bestStreak: 0,
      typed: 0,
      correct: 0,
      level: 1,
      animationFrame: null,
      spawnInterval: null
    };

    function resetCustom(){ customWords.value = defaultWords.join(','); applyWordPool(); }
    function applyWordPool(){
      const txt = customWords.value.trim();
      const list = txt ? txt.split(',').map(s=>s.trim()).filter(Boolean) : [];
      game.wordsPool = list.length ? list : [...defaultWords];
      game.wordIndex = 0;
      renderPreview();
    }

    function renderPreview(){ wordsPreview.innerHTML=''; game.wordsPool.slice(0,8).forEach(w=>{ const d=document.createElement('div'); d.className='word-pill'; d.style.padding='6px 8px'; d.textContent=w; wordsPreview.appendChild(d); }); }

    function spawnWord(){
      if(!game.running) return;
      if(game.falling.length >= game.spawnMax) return;
      const w = game.wordsPool[game.wordIndex];
      game.wordIndex = (game.wordIndex + 1) % game.wordsPool.length; // loop endlessly

      const el = document.createElement('div');
      el.className = 'falling-word';
      el.textContent = w;
      playArea.appendChild(el);

      // random horizontal position inside playArea, keeping padding
      const pad = 12;
      const areaW = playArea.clientWidth;
      const x = Math.max(pad, Math.random()*(areaW - el.offsetWidth - pad));
      el.style.left = x + 'px';
      el.style.top = '-40px';

      const speedBase = 20 + Math.random()*20; // px per second
      const obj = {text: w, el, x, y: -40, speed: speedBase, removed:false};
      game.falling.push(obj);
    }

    function startSpawning(){
      clearInterval(game.spawnInterval);
      game.spawnInterval = setInterval(()=>{ spawnWord(); }, 900);
    }

    function stopSpawning(){ clearInterval(game.spawnInterval); game.spawnInterval = null; }

    function gameLoop(){
      const now = performance.now();
      let last = game._lastTime || now;
      const dt = Math.min(50, now - last); // cap dt
      game._lastTime = now;

      // move words
      for(let i=game.falling.length-1;i>=0;i--){
        const f = game.falling[i];
        if(f.removed) continue;
        f.y += (f.speed * dt / 1000);
        f.el.style.top = f.y + 'px';
        // check collision with red line
        const redTop = redlineEl.getBoundingClientRect().top - playArea.getBoundingClientRect().top;
        if(f.y + f.el.offsetHeight >= redTop){
          // hit the red line -> lose
          endGame(true);
          return; // stop loop
        }
        // remove off-screen (shouldn't happen) but keep safe
        if(f.y > playArea.clientHeight + 40){
          f.el.remove(); game.falling.splice(i,1);
        }
      }

      game.animationFrame = requestAnimationFrame(gameLoop);
    }

    function startGame(){
      if(game.running) return;
      game.running = true;
      game.score = 0; game.streak = 0; game.typed = 0; game.correct = 0; game.bestStreak = game.bestStreak || 0; game.level = 1;
      updateHUD();
      startSpawning();
      game._lastTime = performance.now();
      if(game.animationFrame) cancelAnimationFrame(game.animationFrame);
      game.animationFrame = requestAnimationFrame(gameLoop);
      input.disabled = false; input.focus();
    }

    function pauseGame(){
      game.running = false;
      stopSpawning();
      if(game.animationFrame) cancelAnimationFrame(game.animationFrame);
      game.animationFrame = null;
      input.disabled = true;
    }

    function endGame(hit=false){
      pauseGame();
      // clear falling words visually
      game.falling.forEach(f=>{ try{ f.el.remove(); }catch(e){} });
      game.falling = [];
      game.wordIndex = 0;
      updateHUD();
      if(hit){
        alert(`Oh no â€” a word hit the red line!
Score: ${game.score}
Best streak: ${game.bestStreak}`);
      }
    }

    function removeFalling(f){
      f.removed = true;
      try{ f.el.remove(); }catch(e){}
      const idx = game.falling.indexOf(f); if(idx>=0) game.falling.splice(idx,1);
    }

    function handleSubmit(text){
      const trimmed = text.trim(); if(!trimmed) return;
      game.typed += 1;
      // find a matching falling word (exact match)
      const found = game.falling.find(f => f.text.toLowerCase() === trimmed.toLowerCase());
      if(found){
        // correct
        game.correct += 1; game.score += 10 + game.streak*2; game.streak += 1; if(game.streak>game.bestStreak) game.bestStreak = game.streak;
        // jump animation
        const jumper = document.getElementById('jumper');
        jumper.style.animation = 'none'; void jumper.offsetWidth; jumper.style.animation = 'jump 700ms cubic-bezier(.22,.9,.35,1)';
        setTimeout(()=>{ jumper.style.animation = 'none'; },700);
        removeFalling(found);
      } else {
        // wrong
        game.streak = 0; game.score = Math.max(0, game.score - 2);
      }
      input.value = '';
      updateHUD();
    }

    input.addEventListener('keydown', (e)=>{
      if(e.key === 'Enter' || e.key === ' '){
        e.preventDefault(); handleSubmit(input.value);
      }
    });

    startBtn.addEventListener('click', ()=>{ startGame(); });
    stopBtn.addEventListener('click', ()=>{ pauseGame(); });

    applyWords.addEventListener('click', ()=>{ applyWordPool(); });
    resetWords.addEventListener('click', ()=>{ resetCustom(); });

    spawnRange.addEventListener('input', ()=>{ game.spawnMax = Number(spawnRange.value); spawnLabel.textContent = spawnRange.value; });
    spawnLabel.textContent = spawnRange.value; game.spawnMax = Number(spawnRange.value);

    function updateHUD(){
      scoreEl.textContent = 'Score: '+game.score;
      streakEl.textContent = game.streak;
      accuracyEl.textContent = game.typed? Math.round((game.correct/game.typed)*100)+'%':'100%';
      bestStreakEl.textContent = game.bestStreak;
      typedCountEl.textContent = game.typed;
      levelLabel.textContent = game.level;
    }

    // init
    resetCustom();
    updateHUD();

    // keyboard quick focus
    window.addEventListener('keydown', (e)=>{ if(e.key === 'Tab'){ e.preventDefault(); input.focus(); } });
  </script>
</body>
</html>
